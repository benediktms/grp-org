// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id                  Int       @id @default(autoincrement())
  createdAt           DateTime  @default(now())
  updatedAt           DateTime  @updatedAt
  email               String    @unique
  firstName           String    @db.VarChar(100)
  lastName            String    @db.VarChar(100)
  passwordHash        String
  refreshTokenVersion Int       @default(0)
  authToken           String?   @unique @db.VarChar(40)
  authTokenExpiresAt  DateTime?
  hasConfirmedEmail   Boolean   @default(true)

  Membership Membership[]
}

model Collective {
  id       Int                  @id @default(autoincrement())
  name     String
  features CollectiveFeatures[]

  Membership Membership[]
}

enum CollectiveFeatures {
  PLANNER
  CHAT
  COST_SPLITTING
}

model Membership {
  id   Int            @id @default(autoincrement())
  type MembershipType

  Collective   Collective @relation(fields: [collectiveId], references: [id])
  collectiveId Int
  User         User       @relation(fields: [userId], references: [id])
  userId       Int
}

enum MembershipType {
  ADMIN
  MEMBER
}
